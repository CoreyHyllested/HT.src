{% extends 'sc_header.html' %}
{% set title='Edit your Soulcrafting project' %}

{% block header_css %}
	{{ super() }}
	<link rel="stylesheet" href="/static/css/modern_proj.css"><!-- contains dropzone overrides -->
	<link rel="stylesheet" href='//cdnjs.cloudflare.com/ajax/libs/fullcalendar/2.3.0/fullcalendar.min.css'>
	<link rel="stylesheet" href="//code.jquery.com/ui/1.11.2/themes/smoothness/jquery-ui.css">
	<style> 
		.fc-content .fc-time { display : none !important; }
	</style>
{% endblock %}


{% block header_js %}
	{{ super() }}
	<script src='//cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment.min.js'></script>
	<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&libraries=places&key=AIzaSyCK69MRpXo5CQA6HgoPk0tZxqkDD-SkXXk"></script>
	<script src="/static/js/maps.js">
	<script src='//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
	<script src="//code.jquery.com/ui/1.11.2/jquery-ui.js"></script>
{% endblock %}



{% block content %}
<div class="project-wrapper">

	<div id="project-header">
		<div class="col-md-2 col-xs-2"> <a title="Back to dashboard" href="/dashboard">To Dashboard</a> </div>
		<div class="col-md-8 col-xs-8 text-center"> Project Information </div>
	</div>
  
			<form id="project-details" enctype="multipart/form-data">
				{{form.hidden_tag()}}
				<div id="basic-details">
					{{form.proj_id(placeholder="id") }}
					<div class="container-fluid p10">
						<div class="formFieldInfo  col-lg-2 col-md-2 col-xs-6">Project Name</div>
						{{form.proj_name(placeholder="Update attic.", maxlength="40", class="formField first col-lg-10 col-md-8 col-xs-12")}}
						<div class="formFieldError col-lg-1 col-md-2 col-xs-6"></div>
					</div>

					<div class="container-fluid p10">
						<div class="formFieldInfo  col-lg-2 col-md-2 col-xs-6">What are your goals?</div>
						{{form.proj_desc(placeholder="I want to transform the attic above my garage into a studio to rent on Airbnb.", class="formField col-lg-10 col-md-8 col-xs-12")}}	
						<div class="formFieldError col-lg-1 col-md-2 col-xs-6"></div>
					</div>

					<div class="container-fluid p10">
						<div class="formFieldInfo  col-lg-2 col-md-2 col-xs-6">Where is your home?</div>
						{{form.proj_addr(placeholder="Address", class="formField col-lg-10 col-md-8 col-xs-12")}}
						<div class="scheduleMap col-lg-push-2 col-lg-10 col-md-push-2 col-md-8 col-xs-12" id="map-canvas" data-location='Boulder, CO' data-uuid='4'></div>
					</div>

					<div class="container-fluid p10">
						<div class="formFieldInfo  col-lg-2 col-md-2 col-xs-6">What is your timeline?</div>
						{{form.proj_timeline(placeholder="I'd like to complete this project as soon as possible.", class="formField col-lg-3 col-md-8 col-xs-12")}}
						<div class="formFieldError col-lg-1 col-md-2 col-xs-6"></div>
					</div>

					<div class="container-fluid p10">
						<div class="formFieldInfo  col-lg-2 col-md-2 col-xs-6">What is your budget?</div>
						{{form.proj_max(placeholder="$7000", maxlength="7", class="formField col-lg-3 col-md-8 col-xs-12")}}
						<div class="formFieldError col-lg-1 col-md-2 col-xs-6"></div>
					</div>



						<!--div class="formFieldInfo">What phone number are you available at?  We keep <em>NEVER</em> sell your data (includes your phone number). </div>
						<div class="formFieldError"></div>
						{ {form.proj_contact(placeholder="(555) 303-1234", class="formField span4")} } -->

					<!--div class="container-fluid">
						<div class="formFieldInfo first">Schedule when you are available to have us call you.  It should take about 30 minutes.  All times are in Mountain Standard Time (MST).  </div>
						<fieldset id="editProfAvailTimes">
							<div class="editProfAvailDay">
								{ {form.avail_day(id="day", class="daySelector")}} <label for="sun">What Day?</label>
								{ {form.avail_time(class="formField timeSelector span2")}}
							</div> 	
						</fieldset>
					</div-->

					<div id="status"></div>
					<button id="save-project" class="btn btn-block whiteButton"><span id='save-btn-text'>Save project</span></button>
					
				<!-- ending general, class=editProfFormPage"-->
				</div>
			</form>
			<!--div id='calendar'></div-->
			<!-- ending editProfFormPageContainer-->

	<!--ENDING 'project-wrapper'-->
</div>
{% endblock %}


{% block scripts %}
	{{ super() }}
	<script src="/static/js/edit_project.js"></script>
	<script src='//cdnjs.cloudflare.com/ajax/libs/fullcalendar/2.1.1/fullcalendar.js' ></script>
	<script>
	$(document).ready(function() {
		
		$('#calendar').fullCalendar({
			header: {
				left: 'prev, today',
				center: 'title',
				right: 'next'
			},

			defaultView: 'agendaWeek',
			allDaySlot: false,
			minTime: '6:00:00',
			maxTime: '21:00:00',

			//events.
			eventDurationEditable: false,
			forceEventDuration: true,
			eventRender: function(event, element) {
				phone = $('#proj_contact').val(); 
				$(element).tooltip({title: 'Soulcrafting will call you at ' + phone + ' (30 min)'});
			},
			selectable: true,
			selectHelper: true,
			defaultTimedEventDuration: '00:30',
			//eventClick: function(calEvent, jsEvent, view) { },
			select: function(start, end) {
				var phone = $('#proj_contact').val(); 
				if (phone == '') {
					//this is not enough right now.
					alert('No phone provided');
					return false;
				}
				var newMeeting = {
					title: 'Call with Soulcrafting:\n'+phone,
					start: start,
				};
				
				$('#calendar').fullCalendar('removeEvents');
				$('#calendar').fullCalendar('renderEvent', newMeeting, true); // stick? = true
				$('#calendar').fullCalendar('unselect');
			},
			editable: true,
			eventLimit: true, // allow "more" link when too many events
			events: [ ]
		});

		google.maps.event.addDomListener(window, 'load', initialize);
	});
	</script>
{% endblock %}


# Add ability to delete.
