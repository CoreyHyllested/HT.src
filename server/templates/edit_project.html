{% extends 'sc_header.html' %}
{% set title='Edit your Soulcrafting project' %}

{% block header_css %}
	{{ super() }}
	<link rel="stylesheet" href="/static/css/modern_proj.css"><!-- contains dropzone overrides -->
	<link rel="stylesheet" href='//cdnjs.cloudflare.com/ajax/libs/fullcalendar/2.3.0/fullcalendar.min.css'>
	<link rel="stylesheet" href="//code.jquery.com/ui/1.11.2/themes/smoothness/jquery-ui.css">
	<style> 
		.fc-content .fc-time { display : none !important; }
	</style>
{% endblock %}


{% block header_js %}
	{{ super() }}
	<script src='//cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment.min.js'></script>
	<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&libraries=places"></script>
	<script src="/static/js/maps.js">
	<script src='//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
	<script src="//code.jquery.com/ui/1.11.2/jquery-ui.js"></script>
{% endblock %}



{% block content %}
<div class="project-wrapper">

	<div id="project-header">
		<div class="col-md-3 col-xs-4"> <a title="Back to your dashboard" href="/dashboard">Dashboard</a> </div>
		<div class="col-md-6 col-xs-8 text-center"> Project Information </div>
	</div>
  
		<div id="project" class="col-lg-9 col-md-9 col-sm-9 col-xs-12">
			<form id="project-details" enctype="multipart/form-data">
				{{form.hidden_tag()}}
				<div id="basic-details">
					{{form.proj_id(placeholder="id") }}
					<div class="container-fluid p10">
						<div class="formFieldInfo  col-lg-3 col-md-3 col-xs-6">Project name</div>
						{{form.proj_name(placeholder="Update attic.", maxlength="40", class="formField col-lg-9 col-md-9 col-xs-12")}}
						<div class="formFieldError col-lg-push-3 col-lg-9 col-md-push-3 col-md-9 col-xs-12"></div>
					</div>

					<div class="container-fluid p10">
						<div class="formFieldInfo  col-lg-3 col-md-3 col-xs-6">What are your goals?</div>
						{{form.proj_desc(placeholder="Airbnb conversion.", class="formField col-lg-9 col-md-9 col-xs-12")}}
						<div class="formFieldError col-lg-push-3 col-lg-9 col-md-push-3 col-md-9 col-xs-12"></div>
					</div>

					<div class="container-fluid p10">
						<div class="formFieldInfo  col-lg-3 col-md-3 col-xs-6">Where is your home?</div>
						{{form.proj_addr(placeholder='1050 Walnut Street, Suite 202, Boulder, CO 80302', class="formField col-lg-9 col-md-9 col-xs-12")}}
						{% if form.proj_addr.data %}
						<div class="scheduleMap col-lg-push-3 col-lg-9 col-md-push-3 col-md-9 col-xs-12" id="map-canvas" data-location='{{form.proj_addr.data}}' data-uuid='4'></div>
						{% else%}
						<div class="scheduleMap col-lg-push-3 col-lg-9 col-md-push-3 col-md-9 col-xs-12" id="map-canvas" data-location='1050 Walnut Street, Suite 202, Boulder, CO 80302' data-uuid='4'></div>
						{% endif %}
						<div class="formFieldError col-lg-push-3 col-lg-9 col-md-push-3 col-md-9 col-xs-12"></div>
					</div>

					<div class="container-fluid p10">
						<div class="formFieldInfo  col-lg-3 col-md-3 col-xs-6">What is your timeline?</div>
						{{form.proj_timeline(placeholder="I'd like to complete this project as soon as possible.", class="formField col-lg-9 col-md-9 col-xs-12")}}
						<div class="formFieldError col-lg-push-3 col-lg-9 col-md-push-3 col-md-9 col-xs-12"></div>
					</div>

					<div class="container-fluid p10">
						<div class="formFieldInfo  col-lg-3 col-md-3 col-xs-6">What is your budget?</div>
						{{form.proj_max(placeholder="$ 10,000", maxlength="7", class="formField col-lg-9 col-md-9 col-xs-12")}}
						<div class="formFieldError col-lg-push-3 col-lg-9 col-md-push-3 col-md-9 col-xs-12"></div>
					</div>

					<div class='container-fluid p10'>
						<div title='This is only needed if you want to schedule a time where we call you' class="formFieldInfo  col-lg-3 col-md-3 col-xs-6">Phone number?</div>
						{{form.proj_contact(placeholder="(555) 303-1234", title="(optional)", class="formField col-lg-9 col-md-9 col-xs-12")}} 
						<div class="formFieldError col-lg-push-3 col-lg-9 col-md-push-3 col-md-9 col-xs-12"></div>
					</div>

					<!--div class='container-fluid'>
						<div class="formFieldInfo  col-lg-2 col-md-2 col-xs-6">When should we reach out?</div>
						<div id='calendar' class='col-lg-10 col-md-8 col-xs-12'></div>
					</div-->

					<br>
					<div class="container-fluid p10">
						<button class="btn btn-block blueButton save-project"><span class='save-btn-text'>Save project</span></button>
					</div>
				</div>
			</form>




			<div id="actions" class="container-fluid">
				<div id="actions-next" class="disabled">
					<h3 class="underlined">Next Steps</h3>
					<p> Schedule time with your Soulcrafting concierge so that we can better understand your project goals. Phone calls work best but we can also chat by email.</p>
					<p>
						<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
							<button id="schedule_phone" class="btn btn-block whiteButton disabled">Schedule call</button>
						</div>
						<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
							<button id="schedule_email" class="btn btn-block whiteButton disabled">Request email</button>
						</div>
					</p>
				</div>
			</div>
		</div>

		<div id="actions" class="col-lg-3 col-md-3 col-sm-3 col-xs-12">
			<!--button id="save-project" class="btn btn-block whiteButton save-project"><span class='save-btn-text'>Save project</span></button-->
		</div>

</div>
{% endblock %}


{% block scripts %}
	{{ super() }}
	<script src="/static/js/edit_project.js"></script>
	<script src='//cdnjs.cloudflare.com/ajax/libs/fullcalendar/2.1.1/fullcalendar.js' ></script>
	<script>
	$(document).ready(function() {
		
		$('#calendar').fullCalendar({
			header: {
				left: 'prev, today',
				center: 'title',
				right: 'next'
			},

			defaultView: 'agendaWeek',
			allDaySlot: false,
			minTime: '6:00:00',
			maxTime: '21:00:00',

			//events.
			eventDurationEditable: false,
			forceEventDuration: true,
			eventRender: function(event, element) {
				phone = $('#proj_contact').val(); 
				$(element).tooltip({title: 'Soulcrafting will call you at ' + phone + ' (30 min)'});
			},
			selectable: true,
			selectHelper: true,
			defaultTimedEventDuration: '00:30',
			//eventClick: function(calEvent, jsEvent, view) { },
			select: function(start, end) {
				var phone = $('#proj_contact').val(); 
				if (phone == '') {
					//this is not enough right now.
					alert('No phone provided');
					return false;
				}
				var newMeeting = {
					title: 'Call with Soulcrafting:\n'+phone,
					start: start,
				};
				
				$('#calendar').fullCalendar('removeEvents');
				$('#calendar').fullCalendar('renderEvent', newMeeting, true); // stick? = true
				$('#calendar').fullCalendar('unselect');
			},
			editable: true,
			eventLimit: true, // allow "more" link when too many events
			events: [ ]
		});

		google.maps.event.addDomListener(window, 'load', initialize);
	});
	</script>
{% endblock %}


# Add ability to delete.
